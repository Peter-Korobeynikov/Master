<?php
/*******************************************************************************************
*   ___  _          ______                     _ _                _                        *
*  / _ \| |         | ___ \                   | (_)              | |              Â© 2020   *
* / /_\ | | _____  _| |_/ /_ __ __ _ _ __   __| |_ _ __   __ _   | |_ ___  __ _ _ __ ___   *
* |  _  | |/ _ \ \/ / ___ \ '__/ _` | '_ \ / _` | | '_ \ / _` |  | __/ _ \/ _` | '_ ` _ \  *
* | | | | |  __/>  <| |_/ / | | (_| | | | | (_| | | | | | (_| |  | ||  __/ (_| | | | | | | *
* \_| |_/_|\___/_/\_\____/|_|  \__,_|_| |_|\__,_|_|_| |_|\__, |  \___\___|\__,_|_| |_| |_| *
*                                                         __/ |                            *
*                                                        |___/                             *
* ---------------------------------------------------------------------------------------- *
* This is commercial software, only users who have purchased a valid license and accept    *
* to the terms of the License Agreement can install and use this program.                  *
* ---------------------------------------------------------------------------------------- *
* website: https://cs-cart.alexbranding.com                                                *
*   email: info@alexbranding.com                                                           *
*******************************************************************************************/
if (!defined('BOOTSTRAP')) {
die('Access denied');}
use Tygh\Registry;foreach (glob(Registry::get('config.dir.addons').'ab__fast_navigation/functions/ab__fn_*.php') as $functions) {
require_once $functions;}
function fn_ab__fast_navigation_install(){
$objects=[
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'QDt0dWJ1amRgZWJ1Yg==')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))=>[
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'YmNgYGdvYG5mb3ZgdHVidXZ0')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNPIw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'YmNgYGdvYG1iY2ZtYGRwbXBz')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicyk4KiFPUFUhT1ZNTSFFRkdCVk1VISMkZ2dnZ2dnIw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'YmNgYGdvYG1iY2ZtYGNiZGxoc3B2b2U=')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicyk4KiFPUFUhT1ZNTSFFRkdCVk1VISMkNDQ0NDQ0Iw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'YmNgYGdvYHZ0ZmBwc2poam9gam5iaGY=')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNPIw=='))],
],
],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))=>'?:static_data_descriptions',
call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))=>[
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_text',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'d2JzZGlicykyMTEqIU9QVSFPVk1NIUVGR0JWTVUhIyM='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_show',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNaIw=='))],
],
],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))=>'?:categories',
call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))=>[
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_category_status',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNaIw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_color',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicyk4KiFPUFUhT1ZNTSFFRkdCVk1VISMkZ2dnZ2dnIw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_background',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicyk4KiFPUFUhT1ZNTSFFRkdCVk1VISMkNDQ0NDQ0Iw=='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_use_origin_image',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNPIw=='))],
],
],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))=>'?:category_descriptions',
call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))=>[
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_text',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'d2JzZGlicykyMTEqIU9QVSFPVk1NIUVGR0JWTVUhIyM='))],
[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))=>'ab__fn_label_show',call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))=>call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZGlicykyKiFPUFUhT1ZNTSFFRkdCVk1VISNaIw=='))],
],
],
];if (!empty($objects) && call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'anRgYnNzYno=')),$objects)) {
foreach ($objects as $o) {
$fields=call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZWNgaGZ1YGdqZm1ldA==')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'RUZURFNKQ0Yh')).$o[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))]);if (!empty($fields) && call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'anRgYnNzYno=')),$fields)) {
if (!empty($o[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))]) && call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'anRgYnNzYno=')),$o[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))])) {
foreach ($o[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ag=='))] as $f) {
if (!call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'am9gYnNzYno=')),$f[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))],$fields)) {
call_user_func(call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'ZWNgcnZmc3o=')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'Qk1VRlMhVUJDTUYhQHEhQkVFIUBxIUBx')),$o[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'dQ=='))],$f[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'bw=='))],$f[call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:bc`41bg1:````')),call_user_func(call_user_func(ab_____('tus`sfqmbdf'),'30af09','',ab_____('41bg1:cbtf7541bg1:`efdpef')),'cQ=='))]);}}}}}}}
function fn_ab__fn_get_menu_items($item,$params){
$items=fn_get_menu_items('',$params,'');$items=array_filter($items,'ab__fn_filter_items_by_status');$images=fn_get_image_pairs(array_keys($items),'ab__fn_menu_icon','M',true,false);foreach ($items as $key=>&$item) {
if (!empty($images[$key])) {
$item['image']=array_shift($images[$key]);} elseif (!empty($item['param_3']) && strpos($item['param_3'],'C') !== false) {
$str=stristr(substr(stristr($item['param_3'],':'),1),':',true);$item['image']=fn_get_image_pairs($str,'category','M',false,true);}
if (!empty($item['subitems'])) {
fn_ab__fn_subelements_get_images($item);}}
return $items;}
function fn_ab__fn_subelements_get_images(&$item){
$cat_images=$item_images=[];foreach ($item['subitems'] as $subkey=>&$subitem) {
unset($subitem['subitems']);if (!isset($subitem['param_3']) && strpos($subitem['href'],'categories.view') !== false) {
list(,$category_id)=explode('=',$subitem['href']);$subitem['is_category']=$category_id;$subitem['ab__fn_use_origin_image']='N';$cat_images[]=$category_id;} else {
$item_images[]=$subitem['param_id'];}}
if (!empty($cat_images)) {
$cat_images=fn_get_image_pairs(array_unique($cat_images),'category','M',false,true);}
if (!empty($item_images)) {
$item_images=fn_get_image_pairs(array_unique($item_images),'ab__fn_menu_icon','M',true,false);}
$item['subitems']=array_filter($item['subitems'],'ab__fn_filter_items_by_status');unset($subitem);foreach ($item['subitems'] as $subkey=>&$subitem) {
if (!empty($subitem['is_category']) && !empty($cat_images[$subitem['is_category']])) {
$subitem['image']=array_shift($cat_images[$subitem['is_category']]);} elseif (!empty($item_images[$subitem['param_id']])) {
$subitem['image']=array_shift($item_images[$subitem['param_id']]);}}}
function ab__fn_filter_items_by_status($item){
if ($item['ab__fn_menu_status'] == 'Y' || !empty($item['is_category'])) {
return $item;}}
function fn_ab__fn_get_element_childs($parent_id,$type){
$answ=[];if ($type == 'M') {
$item=db_get_row('SELECT *
FROM ?:static_data AS sd
INNER JOIN ?:static_data_descriptions AS sdd
ON sd.param_id=sdd.param_id
WHERE sd.param_id=?i
AND lang_code=?s',$parent_id,CART_LANGUAGE);$item['subitems']=db_get_hash_array('SELECT *
FROM ?:static_data AS sd
INNER JOIN ?:static_data_descriptions AS sdd
ON sd.param_id=sdd.param_id
WHERE sd.parent_id=?i
AND lang_code=?s','param_id',$parent_id,CART_LANGUAGE);$item=fn_top_menu_form([$parent_id=>$item]);foreach ($item as &$i) {
fn_ab__fn_subelements_get_images($i);$answ=$i;}} else {
$answ['subitems']=fn_get_subcategories($parent_id);foreach ($answ['subitems'] as &$category) {
fn_ab__fn_rename_subcategory_item_fields($category);}}
return $answ;}
function fn_ab__fn_rename_subcategory_item_fields(&$item){
$rename_arr=[
'main_pair'=>[
'name'=>'image',
'subelems'=>[
'detailed'=>'icon',
],
],
'category'=>'item',
];foreach ($rename_arr as $key=>$rename_elem) {
if (is_array($rename_elem)) {
$item[$rename_elem['name']]=$item[$key];if ($rename_elem['subelems']) {
foreach ($rename_elem['subelems'] as $old_name=>$new_name) {
$item[$rename_elem['name']][$new_name]=$item[$rename_elem['name']][$old_name];unset($item[$rename_elem['name']][$old_name]);}}} else {
$item[$rename_elem]=$item[$key];}
unset($item[$key]);}
$item['href']='categories.view&category_id='.$item['category_id'];}
function fn_ab__fn_get_subcategory_items(){
$subcats=[];if (!empty($_REQUEST['category_id'])) {
$category_id=$_REQUEST['category_id'];$subcats=fn_get_subcategories($category_id);$forced_one_level=true;if (!empty($subcats)) {
foreach ($subcats as &$subcat) {
$subcat_id=$subcat['category_id'];$subcat_subitems=fn_get_subcategories($subcat_id);fn_ab__fn_rename_subcategory_item_fields($subcat);if (!empty($subcat_subitems)) {
$forced_one_level=false;foreach ($subcat_subitems as &$subcat_subitem) {
fn_ab__fn_rename_subcategory_item_fields($subcat_subitem);}
$subcat['subitems']=$subcat_subitems;}}}
Tygh::$app['view']->assign('ab__fn_forced_one_level_view',$forced_one_level);}
return $subcats;}
function fn_ab__fn_ajax_save($data,$id,$type='ab__fast_navigation',$lang_code=CART_LANGUAGE){
static $init_cache=['ab__fast_navigation'=>false,'ab__fast_navigation_categories'=>false];$cache_name='ab__fn_a'.$type;$key=$id.'_'.$lang_code;if (!$init_cache[$type]) {
$init_cache[$type]=true;$reinit_arr=$type == 'ab__fast_navigation'?['static_data','static_data_descriptions']:['categories','category_descriptions'];Registry::registerCache($cache_name,$reinit_arr,Registry::cacheLevel('static'),true);}
Registry::set($cache_name.'.'.$key,$data);}
function fn_ab__fn_ajax_get($key,$type='ab__fast_navigation'){
static $init_cache=['ab__fast_navigation'=>false,'ab__fast_navigation_categories'=>false];$cache_name='ab__fn_a'.$type;if (!$init_cache[$type]) {
$init_cache[$type]=true;$reinit_arr=$type == 'ab__fast_navigation'?['static_data','static_data_descriptions']:['categories','category_descriptions'];Registry::registerCache($cache_name,$reinit_arr,Registry::cacheLevel('static'),true);}
static $data;if (empty($data)) {
$data=Registry::get($cache_name);}
return isset($data[$key])?$data[$key]:'';}
function fn_ab__fast_navigation_abt__check_versions(&$ret,$theme) {
$ret['addons']['ab__fast_navigation']='v'.fn_get_addon_version('ab__fast_navigation');}